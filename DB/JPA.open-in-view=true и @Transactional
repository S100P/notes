–ü—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ **–∫–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞ (Projection + MapStruct)** **–º–æ–∂–Ω–æ –æ—Å—Ç–∞–≤–∏—Ç—å `spring.jpa.open-in-view=true`**, –Ω–æ —ç—Ç–æ **–Ω–µ –ª—É—á—à–∏–π –≤–∞—Ä–∏–∞–Ω—Ç –≤ –∫–æ–º–º–µ—Ä—á–µ—Å–∫–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ**. –î–∞–≤–∞–π —Ä–∞–∑–±–µ—Ä—ë–º, –ø–æ—á–µ–º—É.  

---

## **–ß—Ç–æ –¥–µ–ª–∞–µ—Ç `open-in-view=true`?**  
üîπ –ö–æ–≥–¥–∞ `open-in-view=true`, —Å–µ—Å—Å–∏—è Hibernate **–æ—Å—Ç–∞—ë—Ç—Å—è –æ—Ç–∫—Ä—ã—Ç–æ–π** –Ω–∞ –≤—Å—ë–º –ø—Ä–æ—Ç—è–∂–µ–Ω–∏–∏ HTTP-–∑–∞–ø—Ä–æ—Å–∞ (–¥–∞–∂–µ –ø–æ—Å–ª–µ –≤—ã—Ö–æ–¥–∞ –∏–∑ —Å–µ—Ä–≤–∏—Å–Ω–æ–≥–æ —Å–ª–æ—è).  
üîπ –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –∑–∞–≥—Ä—É–∂–∞—Ç—å –ª–µ–Ω–∏–≤—ã–µ (`LAZY`) —Å–≤—è–∑–∏ **–¥–∞–∂–µ –≤ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–µ**.  

‚úÖ **–ü—Ä–∏–º–µ—Ä (–µ—Å–ª–∏ `open-in-view=true`)**
```java
@GetMapping("/{id}")
public AuthorDTO getAuthor(@PathVariable Integer id) {
    var author = service.findById(id);
    return mapper.toDTO(author); // –ó–¥–µ—Å—å Hibernate –≤—Å–µ –µ—â–µ –º–æ–∂–µ—Ç –ø–æ–¥–≥—Ä—É–∑–∏—Ç—å publishers
}
```
–ó–¥–µ—Å—å `publishers` –ø–æ–¥–≥—Ä—É–∑—è—Ç—Å—è –¥–∞–∂–µ **–ø–æ—Å–ª–µ –≤—ã—Ö–æ–¥–∞ –∏–∑ —Å–µ—Ä–≤–∏—Å–Ω–æ–≥–æ —Å–ª–æ—è**, –ø–æ—Ç–æ–º—É —á—Ç–æ —Å–µ—Å—Å–∏—è –µ—â—ë –∞–∫—Ç–∏–≤–Ω–∞.

---

## **–ü–æ—á–µ–º—É –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ `open-in-view=true` ‚Äî –ø–ª–æ—Ö–∞—è –ø—Ä–∞–∫—Ç–∏–∫–∞?**
1Ô∏è‚É£ **–ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä –Ω–µ –¥–æ–ª–∂–µ–Ω –∑–∞–≤–∏—Å–µ—Ç—å –æ—Ç Hibernate**  
   - –ï—Å–ª–∏ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—É –Ω—É–∂–Ω—ã `LAZY`-—Å—É—â–Ω–æ—Å—Ç–∏, –∑–Ω–∞—á–∏—Ç, **–Ω–µ –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∑–∏–ª–∏—Å—å –≤ —Å–µ—Ä–≤–∏—Å–µ**.  
   - –≠—Ç–æ –Ω–∞—Ä—É—à–∞–µ—Ç **—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ —Å–ª–æ—ë–≤** (–∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –∑–∞–≤–∏—Å–∏–º—ã–º –æ—Ç JPA).  

2Ô∏è‚É£ **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø–∞–¥–∞–µ—Ç**  
   - –ö–∞–∂–¥—ã–π –ª–µ–Ω–∏–≤—ã–π –≤—ã–∑–æ–≤ (`author.getPublishers()`) –≤—ã–∑—ã–≤–∞–µ—Ç **–Ω–æ–≤—ã–π SQL-–∑–∞–ø—Ä–æ—Å** ‚Üí N+1 –ø—Ä–æ–±–ª–µ–º–∞.  
   - –ï—Å–ª–∏ –≤ —Ü–∏–∫–ª–µ –≤—ã–∑—ã–≤–∞—é—Ç—Å—è —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å—É—â–Ω–æ—Å—Ç–∏, –º–æ–∂–µ—Ç –±—ã—Ç—å **–æ–≥—Ä–æ–º–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ SQL-–∑–∞–ø—Ä–æ—Å–æ–≤**.  

3Ô∏è‚É£ **–¢—Ä—É–¥–Ω–µ–µ –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –æ—à–∏–±–∫–∏**  
   - –ò–Ω–æ–≥–¥–∞ Hibernate –∑–∞–≥—Ä—É–∂–∞–µ—Ç —á–∞—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö, –∞ –ø–æ—Ç–æ–º –≤ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–∏ (`@JsonIgnore` –∏–ª–∏ Jackson) –ø—ã—Ç–∞–µ—Ç—Å—è –ø–æ–¥—Ç—è–Ω—É—Ç—å –æ—Å—Ç–∞–ª—å–Ω–æ–µ **–∏ –≤—ã–±—Ä–∞—Å—ã–≤–∞–µ—Ç `LazyInitializationException`**.  

---

## **–ö–∞–∫ –ø—Ä–∞–≤–∏–ª—å–Ω–æ? (`open-in-view=false`)**
–õ—É—á—à–∏–π –≤–∞—Ä–∏–∞–Ω—Ç –≤ **–∫–æ–º–º–µ—Ä—á–µ—Å–∫–∏—Ö –ø—Ä–æ–µ–∫—Ç–∞—Ö** ‚Äî **–≤—ã–∫–ª—é—á–∏—Ç—å `open-in-view` –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `@Transactional` –≤ —Å–µ—Ä–≤–∏—Å–µ**.  

üìå **–®–∞–≥–∏:**
1. **–û—Ç–∫–ª—é—á–∞–µ–º –≤ `application.yml`:**
   ```yaml
   spring:
     jpa:
       open-in-view: false
   ```
2. **–ó–∞–≥—Ä—É–∂–∞–µ–º –≤—Å—ë –≤ —Å–µ—Ä–≤–∏—Å–µ:**
   ```java
   @Service
   public class AuthorService {
       
       private final AuthorRepository authorRepository;
       
       @Transactional // –°–µ—Å—Å–∏—è –æ—Ç–∫—Ä—ã—Ç–∞ —Ç–æ–ª—å–∫–æ –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö –º–µ—Ç–æ–¥–∞
       public AuthorDTO getAuthorById(Integer id) {
           var author = authorRepository.findById(id)
               .orElseThrow(() -> new RuntimeException("–ê–≤—Ç–æ—Ä –Ω–µ –Ω–∞–π–¥–µ–Ω"));
           return mapper.toDTO(author); // –¢–µ–ø–µ—Ä—å –≤—Å—ë –∑–∞–≥—Ä—É–∂–µ–Ω–æ –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
       }
   }
   ```
3. **–ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä –ø–æ–ª—É—á–∞–µ—Ç —É–∂–µ –ø–æ–ª–Ω–æ—Å—Ç—å—é –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:**
   ```java
   @RestController
   @RequestMapping("/authors")
   public class AuthorController {

       private final AuthorService authorService;

       @GetMapping("/{id}")
       public ResponseEntity<AuthorDTO> getAuthor(@PathVariable Integer id) {
           return ResponseEntity.ok(authorService.getAuthorById(id));
       }
   }
   ```
   
–¢–µ–ø–µ—Ä—å:
‚úî –ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—É **–Ω–µ –Ω—É–∂–Ω–∞ –∞–∫—Ç–∏–≤–Ω–∞—è —Å–µ—Å—Å–∏—è Hibernate**.  
‚úî –í—Å–µ `LAZY`-–¥–∞–Ω–Ω—ã–µ **–∑–∞–≥—Ä—É–∑—è—Ç—Å—è –≤ —Å–µ—Ä–≤–∏—Å–µ**.  
‚úî –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ª—É—á—à–µ, –ø–æ—Ç–æ–º—É —á—Ç–æ **SQL-–∑–∞–ø—Ä–æ—Å—ã –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ–º—ã–µ**.  

---

## **–í—ã–≤–æ–¥**
üìå **–ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—à—å DTO (Projection) + MapStruct, –ª—É—á—à–µ –æ—Å—Ç–∞–≤–∏—Ç—å `open-in-view=false` –∏ –∑–∞–≥—Ä—É–∂–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –≤ —Å–µ—Ä–≤–∏—Å–µ —Å `@Transactional`**.  
üìå –≠—Ç–æ **–ø–æ–≤—ã—Å–∏—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** –∏ **–∏–∑–±–∞–≤–∏—Ç –æ—Ç N+1 –ø—Ä–æ–±–ª–µ–º—ã**.  

üî• –í –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ **–±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –∫–æ–º–ø–∞–Ω–∏–π –æ—Ç–∫–ª—é—á–∞—é—Ç `open-in-view`**, –ø–æ—Ç–æ–º—É —á—Ç–æ –æ–Ω –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –Ω–µ—è–≤–Ω—ã–º –∑–∞–ø—Ä–æ—Å–∞–º –∏ —É—Ö—É–¥—à–∞–µ—Ç –∫–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞–¥ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è–º–∏.

___________________________________________________________________________

—Ç–æ–≥–¥–∞ –º–æ–∂–Ω–æ –ø—Ä–æ—Å—Ç–æ —Å—Ç–∞–≤–∏—Ç—å @Transactional –Ω–∞ –≤—Å–µ —Å–µ—Ä–≤–∏—Å–Ω—ã–µ –º–µ—Ç–æ–¥—ã? –Ø —Å–ª—ã—à–∞–ª, —á—Ç–æ @Transactional —Ç–æ–∂–µ –Ω–µ —Å—Ç–æ–∏—Ç —Å—Ç–∞–≤–∏—Ç—å –≤–µ–∑–¥–µ –∏ –≤—Å—é–¥—É
___________________________________________________________________________

–¢—ã –ø—Ä–∞–≤, **—Å—Ç–∞–≤–∏—Ç—å `@Transactional` –Ω–∞ –≤—Å–µ –º–µ—Ç–æ–¥—ã –ø–æ–¥—Ä—è–¥ ‚Äî –ø–ª–æ—Ö–∞—è –ø—Ä–∞–∫—Ç–∏–∫–∞**. –î–∞–≤–∞–π —Ä–∞–∑–±–µ—Ä—ë–º—Å—è, **–∫–æ–≥–¥–∞ –∏ –≥–¥–µ –µ–≥–æ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –Ω—É–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å**.  

---

## **üìå –ö–æ–≥–¥–∞ `@Transactional` –Ω—É–∂–µ–Ω?**
`@Transactional` **–Ω—É–∂–µ–Ω —Ç–æ–ª—å–∫–æ —Ç–∞–º, –≥–¥–µ**:  
1Ô∏è‚É£ **–ï—Å—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –æ–ø–µ—Ä–∞—Ü–∏–π —Å –ë–î**, –∏ –µ—Å–ª–∏ –æ–¥–Ω–∞ –∏–∑ –Ω–∏—Ö —É–ø–∞–¥—ë—Ç ‚Äî –≤—Å—ë –¥–æ–ª–∂–Ω–æ –æ—Ç–∫–∞—Ç–∏—Ç—å—Å—è.  
   ```java
   @Transactional
   public void saveAuthorWithPublishers(AuthorDTO authorDTO) {
       var author = authorRepository.save(mapper.toAuthorEntity(authorDTO)); // –°–æ—Ö—Ä–∞–Ω—è–µ–º –∞–≤—Ç–æ—Ä–∞
       var publishers = publisherRepository.saveAll(mapper.toPublisherEntities(authorDTO.getPublishers())); // –°–æ—Ö—Ä–∞–Ω—è–µ–º –∏–∑–¥–∞—Ç–µ–ª–µ–π
   }
   ```
   ‚úÖ –ï—Å–ª–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏–∑–¥–∞—Ç–µ–ª–µ–π (`publisherRepository.saveAll`) —É–ø–∞–¥—ë—Ç ‚Äî **–∞–≤—Ç–æ—Ä –Ω–µ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—Å—è**.

2Ô∏è‚É£ **–ï—Å—Ç—å –ª–µ–Ω–∏–≤—ã–µ (`LAZY`) —Å–≤—è–∑–∏, –∫–æ—Ç–æ—Ä—ã–µ –Ω—É–∂–Ω–æ –∑–∞–≥—Ä—É–∑–∏—Ç—å**.  
   ```java
   @Transactional
   public AuthorDTO findById(Integer id) {
       var author = authorRepository.findById(id)
           .orElseThrow(() -> new RuntimeException("–ê–≤—Ç–æ—Ä –Ω–µ –Ω–∞–π–¥–µ–Ω"));
       return mapper.toDTO(author); // –í—Å–µ —Å–≤—è–∑–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, publishers) –∑–∞–≥—Ä—É–∑—è—Ç—Å—è –≤ —Ä–∞–º–∫–∞—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
   }
   ```
   ‚úÖ –ë–µ–∑ `@Transactional` **–º–æ–∂–µ—Ç –±—ã—Ç—å `LazyInitializationException`**, –µ—Å–ª–∏ `publishers` –ª–µ–Ω–∏–≤—ã–µ.

3Ô∏è‚É£ **–ï—Å—Ç—å –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö**  
   –ù–∞–ø—Ä–∏–º–µ—Ä, –ø—Ä–∏ **–æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ —Å—É—â–Ω–æ—Å—Ç–∏**:
   ```java
   @Transactional
   public void updateAuthor(Integer id, AuthorDTO dto) {
       var author = authorRepository.findById(id).orElseThrow();
       author.setFirstName(dto.getFirstName());
       author.setLastName(dto.getLastName());
   }
   ```
   ‚úÖ –ë–µ–∑ `@Transactional` **Hibernate –Ω–µ –∑–∞—Ñ–∏–∫—Å–∏—Ä—É–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è, –µ—Å–ª–∏ –º–µ—Ç–æ–¥ –Ω–µ –≤—ã–∑—ã–≤–∞–µ—Ç `save()`**.

---

## **üö´ –ö–æ–≥–¥–∞ `@Transactional` –Ω–µ –Ω—É–∂–µ–Ω?**
1Ô∏è‚É£ **–ß—Ç–µ–Ω–∏–µ –æ–¥–Ω–æ–π —Å—É—â–Ω–æ—Å—Ç–∏ (–µ—Å–ª–∏ –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –æ–¥–Ω–∏–º –∑–∞–ø—Ä–æ—Å–æ–º)**  
   ```java
   public AuthorDTO findById(Integer id) {
       return authorRepository.findById(id)
           .map(mapper::toDTO)
           .orElseThrow(() -> new RuntimeException("–ê–≤—Ç–æ—Ä –Ω–µ –Ω–∞–π–¥–µ–Ω"));
   }
   ```
   ‚ùå –ó–¥–µ—Å—å `@Transactional` **–Ω–µ –Ω—É–∂–µ–Ω**, –ø–æ—Ç–æ–º—É —á—Ç–æ **–æ–¥–∏–Ω SELECT –∏ –Ω–∏–∫–∞–∫–∏—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π**.

2Ô∏è‚É£ **–ï—Å–ª–∏ –º–µ—Ç–æ–¥ –≤—ã–∑—ã–≤–∞–µ—Ç `save()`, –Ω–æ –≤–Ω—É—Ç—Ä–∏ –Ω–µ—Ç —Å–ª–æ–∂–Ω—ã—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π**  
   ```java
   public AuthorDTO save(AuthorDTO authorDTO) {
       var author = authorRepository.save(mapper.toAuthorEntity(authorDTO));
       return mapper.toDTO(author);
   }
   ```
   ‚ùå `@Transactional` **–Ω–µ –Ω—É–∂–µ–Ω**, –ø–æ—Ç–æ–º—É —á—Ç–æ **–º–µ—Ç–æ–¥ –≤—ã–ø–æ–ª–Ω—è–µ—Ç –æ–¥–Ω—É –æ–ø–µ—Ä–∞—Ü–∏—é –∏ Hibernate —Å–∞–º –æ–±–æ—Ä–∞—á–∏–≤–∞–µ—Ç `save()` –≤ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é**.

3Ô∏è‚É£ **–ï—Å–ª–∏ –º–µ—Ç–æ–¥ —Ç–æ–ª—å–∫–æ –≤—ã–∑—ã–≤–∞–µ—Ç –¥—Ä—É–≥–æ–π `@Transactional`-–º–µ—Ç–æ–¥**  
   ```java
   public void someMethod() {
       updateAuthor(1, new AuthorDTO()); // updateAuthor —É–∂–µ @Transactional
   }
   ```
   ‚ùå `@Transactional` **–Ω–µ –Ω—É–∂–µ–Ω**, –ø–æ—Ç–æ–º—É —á—Ç–æ **–≤–ª–æ–∂–µ–Ω–Ω—ã–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –≤ Spring –Ω–µ —Ä–∞–±–æ—Ç–∞—é—Ç —Ç–∞–∫, –∫–∞–∫ —Ç—ã –¥—É–º–∞–µ—à—å**.  

---

## **üîç –ß—Ç–æ –±—É–¥–µ—Ç, –µ—Å–ª–∏ –ø–æ—Å—Ç–∞–≤–∏—Ç—å `@Transactional` –≤–µ–∑–¥–µ?**
üî¥ **–ü–∞–¥–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏** ‚Äî –¥–∞–∂–µ –ø—Ä–æ—Å—Ç–æ–π `SELECT` –æ–±–µ—Ä–Ω—ë—Ç—Å—è –≤ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é.  
üî¥ **–î–æ–ª–≥–∏–µ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –≤ –ë–î** ‚Äî —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è –¥–µ—Ä–∂–∏—Ç —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Å –ë–î –¥–æ–ª—å—à–µ, —á–µ–º –Ω—É–∂–Ω–æ.  
üî¥ **–ü—Ä–æ–±–ª–µ–º—ã —Å –≤–ª–æ–∂–µ–Ω–Ω—ã–º–∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è–º–∏** ‚Äî Spring –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –Ω–µ —Å–æ–∑–¥–∞—ë—Ç –Ω–æ–≤—ã–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –≤–Ω—É—Ç—Ä–∏ —Ç–µ–∫—É—â–µ–π, –∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –æ–¥–Ω—É –∏ —Ç—É –∂–µ.  

---

## **üìå –í—ã–≤–æ–¥: –≥–¥–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ —Å—Ç–∞–≤–∏—Ç—å `@Transactional`?**
‚úî **–ù–∞ –º–µ—Ç–æ–¥—ã, –∫–æ—Ç–æ—Ä—ã–µ –∏–∑–º–µ–Ω—è—é—Ç –¥–∞–Ω–Ω—ã–µ –∏ —Å–æ—Å—Ç–æ—è—Ç –∏–∑ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —à–∞–≥–æ–≤ (save, update, delete)**  
‚úî **–ù–∞ –º–µ—Ç–æ–¥—ã
